{% extends "base.html" %}

{% block title %}Home - SZABIST MART{% endblock %}

{% block content %}

<!-- Hero Section -->
<section class="relative overflow-hidden bg-gradient-to-br from-blue-50 via-white to-green-50 pt-20 pb-32">
    <!-- Decorative elements -->
    <div class="absolute top-0 right-0 w-96 h-96 bg-gradient-to-l from-brand-green to-transparent rounded-full blur-3xl opacity-20"></div>
    <div class="absolute bottom-0 left-0 w-96 h-96 bg-gradient-to-r from-brand-blue to-transparent rounded-full blur-3xl opacity-20"></div>

    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
            <!-- Left Content -->
            <div class="z-10">
                <h1 class="text-5xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-brand-blue via-brand-green to-brand-blue bg-clip-text text-transparent leading-tight">
                    Fresh Groceries Delivered
                </h1>
                <p class="text-xl text-gray-600 mb-8 leading-relaxed">
                    Welcome to SZABIST MART, your trusted online grocery store. Quality products, competitive prices, and fast delivery at your doorstep.
                </p>
                
                <!-- Search Bar -->
                <div class="mb-8">
                    <div class="relative">
                        <input 
                            type="text" 
                            id="heroSearch" 
                            placeholder="Search for products..." 
                            class="w-full px-6 py-4 rounded-lg border-2 border-blue-200 focus:border-brand-green focus:outline-none text-gray-700 placeholder-gray-400 transition"
                        >
                        <button 
                            onclick="searchFromHero()" 
                            class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-gradient-to-r from-brand-blue to-brand-green text-white px-6 py-2 rounded-lg hover:shadow-lg transition"
                        >
                            Search
                        </button>
                    </div>
                    <div id="searchResults" class="mt-4 bg-white rounded-lg shadow-lg hidden max-h-64 overflow-y-auto"></div>
                </div>

                <!-- CTA Buttons -->
                <div class="flex flex-col sm:flex-row gap-4">
                    <a href="/products" class="bg-gradient-to-r from-brand-blue to-brand-green text-white px-8 py-3 rounded-lg font-semibold hover:shadow-xl transition transform hover:scale-105 text-center">
                        Shop Now
                    </a>
                    <a href="#featured" class="border-2 border-brand-green text-brand-green px-8 py-3 rounded-lg font-semibold hover:bg-green-50 transition text-center">
                        View Featured
                    </a>
                </div>

                <!-- Stats -->
                <div class="grid grid-cols-3 gap-4 mt-12">
                    <div>
                        <p class="text-3xl font-bold text-brand-blue">{{ products|length }}</p>
                        <p class="text-gray-600">Products</p>
                    </div>
                    <div>
                        <p class="text-3xl font-bold text-brand-green">24/7</p>
                        <p class="text-gray-600">Support</p>
                    </div>
                    <div>
                        <p class="text-3xl font-bold text-brand-blue">100%</p>
                        <p class="text-gray-600">Quality</p>
                    </div>
                </div>
            </div>

            <!-- Right Image -->
            <div class="relative z-10 hidden md:block">
                <div class="relative w-full h-96">
                    <div class="absolute inset-0 bg-gradient-to-br from-brand-blue to-brand-green rounded-2xl opacity-10 blur-2xl"></div>
                    <img 
                        src="{{ url_for('static', filename='HOME.png') }}" 
                        alt="Fresh Groceries" 
                        class="w-full h-full object-cover rounded-2xl shadow-2xl"
                        loading="lazy"
                    >
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Categories Overview -->
<section class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-3xl font-bold text-center mb-4 text-gray-900">Shop by Category</h2>
        <p class="text-center text-gray-600 mb-12">Discover our wide range of fresh and quality products</p>
        
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
            {% set categories = [] %}
            {% for product in products %}
                {% if product.category not in categories %}
                    {% set _ = categories.append(product.category) %}
                {% endif %}
            {% endfor %}
            
            {% for category in categories[:6] %}
                <a href="/products?category={{ category }}" class="group">
                    <div class="bg-gradient-to-br from-blue-50 to-green-50 p-6 rounded-lg text-center hover:shadow-lg transition transform hover:scale-105">
                        <div class="text-4xl mb-2">
                            {% if category == 'Grains' %}üåæ
                            {% elif category == 'Essentials' %}üõí
                            {% elif category == 'Dairy' %}ü•õ
                            {% elif category == 'Bakery' %}üçû
                            {% elif category == 'Fruits' %}üçé
                            {% elif category == 'Vegetables' %}ü•ï
                            {% elif category == 'Beverages' %}‚òï
                            {% elif category == 'Spices' %}üå∂Ô∏è
                            {% elif category == 'Snacks' %}üç™
                            {% elif category == 'Frozen' %}üßä
                            {% elif category == 'Meat' %}üçó
                            {% else %}üì¶
                            {% endif %}
                        </div>
                        <h3 class="font-semibold text-gray-800 group-hover:text-brand-green transition">{{ category }}</h3>
                    </div>
                </a>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Featured Products -->
<section id="featured" class="py-16 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-3xl font-bold text-center mb-4 text-gray-900">Featured Products</h2>
        <p class="text-center text-gray-600 mb-12">Check out our best-selling items</p>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
            {% for product in products[:8] %}
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl transition transform hover:scale-105 search-highlight">
                    <div class="relative overflow-hidden bg-gray-200 h-48">
                        <img 
                            src="{{ product.image }}" 
                            alt="{{ product.name }}" 
                            class="w-full h-full object-cover hover:scale-110 transition duration-300"
                            loading="lazy"
                            crossorigin="anonymous"
                            onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22300%22%3E%3Crect fill=%22%23ddd%22 width=%22400%22 height=%22300%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22sans-serif%22 font-size=%2224%22 fill=%22%23999%22%3EImage Not Available%3C/text%3E%3C/svg%3E'"
                        >
                        {% if product.stock == 0 %}
                            <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center">
                                <span class="text-white font-bold text-lg">Out of Stock</span>
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="p-4">
                        <h3 class="font-bold text-lg text-gray-800 mb-2">{{ product.name }}</h3>
                        <p class="text-sm text-gray-600 mb-2">{{ product.category }}</p>
                        <p class="text-xs text-gray-500 mb-3">{{ product.description[:50] }}...</p>
                        
                        <div class="flex justify-between items-center mb-3">
                            <span class="text-2xl font-bold text-brand-green">‚Çπ{{ product.price }}</span>
                            <span class="text-sm bg-blue-100 text-brand-blue px-2 py-1 rounded">{{ product.quantity }}</span>
                        </div>

                        <div class="flex gap-2">
                            <a href="/product/{{ product.product_id }}" class="flex-1 bg-gradient-to-r from-brand-blue to-brand-green text-white py-2 rounded-lg text-center font-semibold hover:shadow-lg transition">
                                View Details
                            </a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="text-center mt-12">
            <a href="/products" class="inline-block bg-gradient-to-r from-brand-blue to-brand-green text-white px-10 py-3 rounded-lg font-semibold hover:shadow-xl transition">
                View All Products
            </a>
        </div>
    </div>
</section>

<!-- Why Choose Us -->
<section class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-3xl font-bold text-center mb-12 text-gray-900">Why Choose SZABIST MART?</h2>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
            <div class="text-center">
                <div class="bg-gradient-to-br from-brand-blue to-brand-green w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
                    </svg>
                </div>
                <h3 class="font-bold text-lg mb-2">100% Fresh</h3>
                <p class="text-gray-600 text-sm">All products are carefully selected and delivered fresh to your door</p>
            </div>

            <div class="text-center">
                <div class="bg-gradient-to-br from-brand-green to-brand-blue w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                </div>
                <h3 class="font-bold text-lg mb-2">Quality Assured</h3>
                <p class="text-gray-600 text-sm">Every product goes through strict quality checks before shipping</p>
            </div>

            <div class="text-center">
                <div class="bg-gradient-to-br from-brand-blue to-brand-green w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
                    </svg>
                </div>
                <h3 class="font-bold text-lg mb-2">Great Prices</h3>
                <p class="text-gray-600 text-sm">Get the best deals on all your favorite grocery items</p>
            </div>

            <div class="text-center">
                <div class="bg-gradient-to-br from-brand-green to-brand-blue w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
                    </svg>
                </div>
                <h3 class="font-bold text-lg mb-2">24/7 Support</h3>
                <p class="text-gray-600 text-sm">Our customer support team is always here to help you</p>
            </div>
        </div>
    </div>
</section>

{% endblock %}

{% block extra_scripts %}
<script>
    function searchFromHero() {
        const searchInput = document.getElementById('heroSearch');
        const query = searchInput.value.trim();

        if (!query) return;

        fetch('/api/search', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ query: query })
        })
        .then(response => response.json())
        .then(results => {
            const searchResults = document.getElementById('searchResults');
            
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="p-4 text-gray-600">No products found.</div>';
            } else {
                searchResults.innerHTML = results.map(product => `
                    <div class="p-3 border-b border-gray-200 hover:bg-blue-50 cursor-pointer transition" onclick="window.location.href='/product/${product.product_id}'">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-semibold text-gray-800">${product.name}</h4>
                                <p class="text-sm text-gray-600">${product.category}</p>
                            </div>
                            <span class="text-brand-green font-bold">‚Çπ${product.price}</span>
                        </div>
                    </div>
                `).join('');
            }
            
            searchResults.classList.remove('hidden');
        });
    }

    // Show/hide search results on input
    document.getElementById('heroSearch').addEventListener('focus', function() {
        if (this.value.trim()) {
            document.getElementById('searchResults').classList.remove('hidden');
        }
    });

    document.getElementById('heroSearch').addEventListener('blur', function() {
        setTimeout(() => {
            document.getElementById('searchResults').classList.add('hidden');
        }, 200);
    });

    // Allow Enter key to search
    document.getElementById('heroSearch').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            searchFromHero();
        }
    });
</script>
{% endblock %}
